import{u as b,a as h,r as i,j as e}from"./index-CUPvuyHl.js";const w=({setAddBillItem:s})=>{const{members:o}=b(),{onAddItem:a}=h(),[r,c]=i.useState([]),[l,x]=i.useState({}),m=i.useRef(""),u=i.useRef(0);function f(t){const n=t.target.value;t.target.id==="selectAll"?t.target.checked===!0?(c(o.map(d=>d.name)),t.target.checked=!t.target.checked):(c([]),t.target.checked=!0):t.target.checked?c([...r,n]):c(r.filter(d=>d!==n))}function p(t){t.preventDefault();let n={};m.current.value.trim()||(n.itemNameError="cannot be empty"),u.current.value.trim()||(n.itemPriceError="cannot be empty"),r.length===0&&(n.membersError="select atleast one member for the split"),Object.keys(n).length===0?(a(t,{itemId:m.current.value.toLowerCase().concat(new Date().getTime()),itemName:m.current.value.toLowerCase(),totalPrice:Math.abs(Number(u.current.value)),membersForTheSplit:r,pricePerHead:Number((u.current.value/r.length).toFixed(3))}),s(!1)):(x(n),setTimeout(()=>{x({})},2e3))}return e.jsxs("div",{className:"flex flex-col space-y-5",children:[e.jsx("input",{type:"text",placeholder:l.itemNameError?`${l.itemNameError}`:"enter the item name",ref:m,className:`mx-auto p-3 bg-transparent w-full max-w-[450px] h-[50px] border-2 ${l.itemNameError?"border-red-400 placeholder:text-red-400":"border-violet-400"} outline-none rounded-md text-lg`}),e.jsx("input",{type:"number",min:0,placeholder:l.itemPriceError?`${l.itemPriceError}`:"enter the item price",ref:u,className:`mx-auto p-3 bg-transparent w-full max-w-[450px] h-[50px] border-2 ${l.itemPriceError?"border-red-400 placeholder:text-red-400":"border-violet-400"} outline-none rounded-md text-lg`}),e.jsxs("div",{className:"mx-auto w-full max-w-[300px] h-[250px] flex flex-col space-y-4 overflow-y-auto",children:[e.jsxs("div",{className:`mx-auto w-full h-[45px] flex items-center justify-center border ${l.membersError?"border-red-400":"border-white"} rounded-lg hover:bg-purple-400`,children:[e.jsx("div",{className:"w-1/5 h-full flex items-center justify-center",children:e.jsx("input",{type:"checkbox",id:"selectAll",className:"w-[20px]",name:"all",value:`${o}`,checked:r.length===o.length,onChange:t=>{f(t)}})}),e.jsx("label",{className:"w-4/5 h-full flex items-center text-lg",htmlFor:"selectAll",children:"select all members"})]}),o.map((t,n)=>e.jsxs("div",{className:`mx-auto w-full h-[45px] flex items-center border ${l.membersError?"border-red-400":"border-white"} rounded-lg hover:bg-purple-400`,children:[e.jsx("div",{className:"w-1/5 h-full flex items-center justify-center",children:e.jsx("input",{type:"checkbox",id:`${t.name}`,className:"w-[20px]",name:`${t.name}`,value:`${t.name}`,checked:r.includes(t.name),onChange:d=>{f(d)}})}),e.jsx("label",{className:"w-4/5 h-full flex items-center text-lg",htmlFor:`${t.name}`,children:t.name})]},n))]}),e.jsxs("div",{className:"relative mx-auto w-full max-w-[450px] h-[50px]",children:[e.jsx("button",{type:"button",className:"absolute h-full w-2/5 max-w-[100px] border hover:bg-green-600 left-0 rounded-md",onClick:t=>{p(t)},children:"add"}),e.jsx("p",{className:"absolute left-[30%] w-2/5 h-full text-red-400 text-center",children:l.membersError}),e.jsx("button",{className:"absolute h-full w-2/5 max-w-[100px] border hover:bg-red-600 right-0 rounded-md",onClick:()=>s(!1),children:"cancel"})]})]})},v=({item:s})=>{const{onDeleteItem:o,country:a}=h();return e.jsxs("div",{className:"mb-3 px-3 pb-2 relative w-full h-fit text-black border-b-2 border-gray-700 flex items-center",children:[e.jsxs("div",{className:"w-4/5 h-full flex flex-col justify-between",children:[e.jsx("div",{className:"pt-1 text-2xl",children:s.itemName.toLowerCase()}),e.jsxs("div",{className:"text-xs italic",children:[s.membersForTheSplit.join(", ")," ",s.membersForTheSplit.length>1?"together owe":"owes"]})]}),e.jsxs("div",{className:"absolute bottom-2 right-2 w-1/5 flex items-end justify-end text-md",children:[JSON.parse(a).currency.symbol_native?JSON.parse(a).currency.symbol_native:JSON.parse(a).currency.code," ",s.totalPrice]}),e.jsx("div",{className:"absolute w-5 h-5 rounded-full top-2 right-2",children:e.jsx("button",{className:"flex items-center justify-center w-full h-full bg-red-500 rounded-full text-white",onClick:r=>{window.confirm(`remove ${s.itemName}(${JSON.parse(a).currency.symbol_native?JSON.parse(a).currency.symbol_native:JSON.parse(a).currency.code}${s.totalPrice}) from the bill?`)&&o(r,s.itemId)},children:"âˆ’"})})]})},N=({setSplitStage:s})=>{const{defaultTitle:o}=b(),{bill:a}=h(),[r,c]=i.useState(!1);return i.useEffect(()=>(document.title="splitverse | bill",function(){document.title=o}),[o]),e.jsxs("div",{className:"absolute flex flex-col justify-between left-[10%] w-4/5 h-2/3 top-[20%]",children:[r&&e.jsx(w,{setAddBillItem:c}),!r&&(a.length>0?e.jsx("div",{className:"mx-auto p-5 w-full max-w-[600px] h-[75%] max-h-[350px] bg-white rounded-tr-2xl rounded-bl-2xl overflow-y-auto",children:a.map(l=>e.jsx(v,{item:l},l.itemId))}):e.jsx("div",{className:"mx-auto p-5 w-full max-w-[600px] h-[75%] max-h-[350px] bg-white rounded-tr-2xl rounded-bl-2xl text-black",children:"recreate the bill, only this time, select members for the split on each item you add."})),!r&&e.jsxs("div",{className:"relative h-[80px] mx-auto w-full max-w-[600px]",children:[e.jsxs("div",{className:"w-full text-center rounded-full italic flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"h-[20px] w-[20px] bg-transparent border border-white rounded-full flex items-center justify-center",children:"!"}),e.jsx("div",{className:"text-xs",children:"can add tax and discount, if any, in the next stage"})]}),a.length>0&&e.jsx("button",{type:"button",className:"absolute bottom-0 left-0 w-2/5 h-[45px] max-w-[200px] bg-black rounded-md hover:bg-purple-400 hover:text-black",onClick:l=>{l.preventDefault(),window.confirm("no further changes to the bill possible, only tax and discount can be added. move on?")&&s("taxAndDiscount")},children:"done"}),e.jsx("button",{type:"button",className:"absolute bottom-0 right-0 text-black w-2/5 max-w-[200px] h-[45px] bg-purple-400 rounded-md hover:text-white",onClick:()=>c(!0),children:"add a new item"})]})]})};export{N as default};
